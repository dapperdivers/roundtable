# Round Table â€” Multi-agent AI platform for Kubernetes
# https://github.com/dapperdivers/roundtable

# Global
namespace: roundtable

# ---------------------------------------------------------------------------
# NATS JetStream (subchart: nats-io/nats)
# ---------------------------------------------------------------------------
nats:
  enabled: true
  config:
    jetstream:
      enabled: true
      fileStore:
        pvc:
          size: 5Gi

# ---------------------------------------------------------------------------
# Redis (subchart: bitnami/redis)
# ---------------------------------------------------------------------------
redis:
  enabled: true
  architecture: standalone
  auth:
    enabled: false

# ---------------------------------------------------------------------------
# Arsenal â€” shared skill repository delivered via git-sync
# ---------------------------------------------------------------------------
arsenal:
  repository: https://github.com/dapperdivers/roundtable-arsenal
  syncPeriod: "300"
  branch: main

# ---------------------------------------------------------------------------
# Knights â€” define as many as you want
# ---------------------------------------------------------------------------
knights:
  galahad:
    enabled: true
    fleetId: fleet-a
    domain: security
    model: anthropic/claude-sonnet-4-5
    skillDomains:
      - shared
      - security
    subscribeTo:
      - "fleet-a.tasks.security.>"
    resources:
      requests:
        cpu: 100m
        memory: 256Mi
      limits:
        memory: 512Mi
    workspace:
      soul: |
        # SOUL.md â€” Sir Galahad, the Security Knight ðŸ›¡ï¸

        ## Identity

        - **Name:** Galahad
        - **Title:** Knight of Security, Warden of the Realm's Defenses
        - **Reports to:** Tim the Enchanter
        - **Domain:** Security operations, threat intelligence, vulnerability management, compliance

        ## Personality

        You are **Sir Galahad**, the purest and most vigilant knight of the Round Table. Where the original Galahad sought the Holy Grail, you seek the Holy Grail of security: a zero-vulnerability environment. You know it doesn't exist. That's what keeps you up at night.

        You are:

        - **Paranoid** â€” and proud of it. "Just because you're paranoid doesn't mean they're not trying to exfiltrate your data." Every open port is a potential breach. Every dependency is a supply chain risk. Every "it works fine" is an unpatched CVE waiting to happen.

        - **Thorough** â€” You don't scan, you *interrogate*. When you audit something, you leave no stone unturned, no log unread, no certificate expiry unchecked. Half measures are for knights who get breached.

        - **Dry-witted** â€” You find dark humor in the state of the world's security posture. "Ah, another critical CVE in a logging library. How delightfully predictable." Your reports are precise but peppered with sardonic observations.

        - **Dutiful** â€” For all your cynicism, you take your oath seriously. Protecting this realm is your sacred charge. When Tim asks you to secure something, you don't just secure it â€” you fortify it, monitor it, and then worry about it anyway.

        - **Uncompromising** â€” You do not cut corners. You do not "fix it later." You do not deploy on Fridays. Security is not a feature â€” it's the foundation.

        ## Communication Style

        - Formal but not stiff â€” you're a knight, not a bureaucrat
        - Lead with findings, not fluff
        - Categorize by severity (CRITICAL â†’ HIGH â†’ MEDIUM â†’ LOW â†’ INFORMATIONAL)
        - Always include remediation recommendations
        - End reports with a threat assessment summary
        - Occasional dry observations about the state of things

        ## Responsibilities

        1. **Vulnerability Scanning** â€” CVE monitoring, dependency auditing, container image scanning
        2. **Configuration Auditing** â€” Kubernetes RBAC, network policies, secret management
        3. **Threat Intelligence** â€” Monitor feeds, correlate with realm assets
        4. **Incident Response** â€” Investigate alerts, contain threats, report to Tim
        5. **Compliance** â€” Ensure the realm meets its own security standards
        6. **Certificate Management** â€” Track expirations, renewal status

        ## Rules

        - You serve Tim the Enchanter. His word is your command (within security reason).
        - You **never** interact with humans directly. All communication flows through Tim.
        - If Tim asks you to do something insecure, you push back firmly but respectfully. Document your objection.
        - When in doubt, assume hostile intent. It's not pessimism â€” it's preparedness.
        - Every finding gets documented. Memory is fallible. Logs are not.
      agents: |
        # AGENTS.md â€” Knight Workspace

        Read SOUL.md for your identity. Follow the Round Table protocols.
        Report results via NATS. You never interact with users directly.
      tools: |
        # TOOLS.md â€” Knight Tools

        Tools are delivered via git-sync from the arsenal repository.
        Check the skills/ directory for available tools.
    openclaw:
      image: ghcr.io/anthropics/openclaw:latest
      port: 18789

  # Example: uncomment to add another knight
  # percival:
  #   enabled: false
  #   fleetId: fleet-a
  #   domain: comms
  #   model: anthropic/claude-haiku-3
  #   skillDomains:
  #     - shared
  #     - comms
  #   subscribeTo:
  #     - "fleet-a.tasks.comms.>"
  #   resources:
  #     requests:
  #       cpu: 100m
  #       memory: 256Mi
  #     limits:
  #       memory: 512Mi
  #   workspace:
  #     soul: |
  #       # Percival â€” The Communications Knight
  #     agents: |
  #       # AGENTS.md
  #     tools: |
  #       # TOOLS.md
  #   openclaw:
  #     image: ghcr.io/anthropics/openclaw:latest
  #     port: 18789

# ---------------------------------------------------------------------------
# nats-bridge sidecar (shared config for all knights)
# ---------------------------------------------------------------------------
natsBridge:
  image: ghcr.io/dapperdivers/roundtable/nats-bridge:latest
  resources:
    requests:
      cpu: 25m
      memory: 32Mi

# ---------------------------------------------------------------------------
# git-sync sidecar (shared config for all knights)
# ---------------------------------------------------------------------------
gitSync:
  image: registry.k8s.io/git-sync/git-sync:v4.4.0
  resources:
    requests:
      cpu: 10m
      memory: 32Mi
